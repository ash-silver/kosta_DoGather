<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.mapper.OrderSheetMapper">
	<resultMap type="com.project.model.PurchaseModel"
		id="OrderSheetMap">
		<id property="o_id" column="o_id" />
		<result property="o_product_p_fk" column="o_product_p_fk" />
		<result property="o_member_m_fk" column="o_member_m_fk" />
		<result property="o_recipient" column="o_recipient" />
		<result property="o_phoneNumber" column="o_phoneNumber" />
		<result property="o_address" column="o_address" />
		<result property="o_date" column="o_date" />
		<result property="o_quantity" column="o_quantity" />
		<result property="o_state" column="o_state" />
	</resultMap>
	
	<resultMap type="com.project.model.Product" id="ProductMap">
		<id property="p_id" column="p_id" />
		<result property="p_name" column="p_name" />
		<result property="p_price" column="p_price" />
		<result property="p_category" column="p_category" />
		<result property="p_duedate" column="p_duedate" />
		<result property="p_recruitdate" column="p_recruitdate" />
		<result property="p_createdate" column="p_createdate" />
		<result property="p_nickname_m_fk" column="p_nickname_m_fk" />
		<result property="p_chk" column="p_chk" />
		<result property="p_sell" column="p_sell" />
		<collection property="img" column="p_id"
			javaType="java.util.ArrayList" ofType="com.project.model.Img"
			select="getImg" />
		<collection property="option" column="p_id"
			javaType="java.util.ArrayList" ofType="com.project.model.Option"
			select="getOpt" />
		<collection property="discount" column="p_id"
			javaType="java.util.ArrayList" ofType="com.project.model.discount"
			select="getDiscount" />
	</resultMap>

	<!-- ==============================join result========================================= -->
<!-- 	<select id="GetProductForOrder" parameterType="int" resultType="int"> -->
<!-- 		SELECT * FROM order  -->
<!-- 		INNER JOIN product ON product.p_id = #{o_product_p_fk} -->
<!-- 	</select> -->

	<!-- ===================================add part ============================== -->

	<insert id="AddOrder"
		parameterType="com.project.model.PurchaseModel"
		useGeneratedKeys="true" keyProperty="o_id">

		INSERT INTO order(
		o_product_p_fk
		, o_member_m_fk
		, o_recipient
		, o_phoneNumber
		, o_address
		, o_date
		, o_quantity
		, o_state
		)
		VALUES(
		#{o_product_p_fk},
		#{o_member_m_fk},
		#{o_recipient},
		#{o_phoneNumber},
		#{o_address},
		NOW(),
		#{o_quantity},
		#{o_state}
		)
	</insert>


</mapper>